<!DOCTYPE html>
<html>
<head>
    <title>Simple Upload Test</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 600px; margin: 0 auto; }
        .result { margin: 20px 0; padding: 15px; border: 1px solid #ddd; white-space: pre-wrap; }
        .error { background: #fee; border-color: #c00; }
        .success { background: #efe; border-color: #0c0; }
        button { padding: 10px 20px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Upload Test - Check Console</h1>

    <p><strong>Instructions:</strong></p>
    <ol>
        <li>Open browser console (F12)</li>
        <li>Select a file below</li>
        <li>Click Upload</li>
        <li>Copy ALL output from console and send to me</li>
    </ol>

    <input type="file" id="fileInput" accept=".pdf,.docx,.doc,.txt">
    <br>
    <button onclick="testUpload()">Upload File</button>

    <div id="result"></div>

    <script>
        async function testUpload() {
            const fileInput = document.getElementById('fileInput');
            const resultDiv = document.getElementById('result');

            if (!fileInput.files || !fileInput.files[0]) {
                alert('Please select a file first');
                return;
            }

            const file = fileInput.files[0];
            console.log('=== UPLOAD TEST START ===');
            console.log('File:', file.name, file.size, 'bytes', file.type);

            try {
                const formData = new FormData();
                formData.append('file', file);

                console.log('Sending POST to /api/resumes/upload...');

                const response = await fetch('https://rewriteme.app/api/resumes/upload', {
                    method: 'POST',
                    body: formData,
                    credentials: 'include'
                });

                console.log('Response status:', response.status, response.statusText);
                console.log('Response headers:', [...response.headers.entries()]);

                const responseText = await response.text();
                console.log('Response body:', responseText);

                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (e) {
                    data = { rawResponse: responseText };
                }

                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.textContent = '✅ SUCCESS!\n\n' + JSON.stringify(data, null, 2);
                    console.log('✅ Upload succeeded:', data);
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = '❌ FAILED!\n\n' +
                        'Status: ' + response.status + '\n' +
                        'Error: ' + JSON.stringify(data, null, 2);
                    console.error('❌ Upload failed:', response.status, data);
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = '❌ EXCEPTION!\n\n' + error.message + '\n\n' + error.stack;
                console.error('❌ Exception:', error);
            }

            console.log('=== UPLOAD TEST END ===');
        }
    </script>
</body>
</html>
